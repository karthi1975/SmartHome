<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Home Controller - High Level Entity Diagram</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
            border-left: 4px solid #3498db;
            padding-left: 15px;
        }
        .diagram {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
            overflow-x: auto;
            border: 1px solid #dee2e6;
        }
        .entity-box {
            background-color: #e3f2fd;
            border: 2px solid #2196f3;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            display: inline-block;
            min-width: 200px;
        }
        .entity-title {
            font-weight: bold;
            color: #1976d2;
            margin-bottom: 8px;
            text-align: center;
        }
        .entity-items {
            font-size: 11px;
            color: #424242;
        }
        .flow-diagram {
            background-color: #f1f8e9;
            border: 1px solid #8bc34a;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        .section {
            margin: 30px 0;
        }
        .legend {
            background-color: #fff3e0;
            border: 1px solid #ff9800;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        .legend-item {
            display: inline-block;
            margin: 5px 15px;
            font-weight: bold;
        }
        .views { color: #e91e63; }
        .viewmodels { color: #9c27b0; }
        .config { color: #ff9800; }
        .apis { color: #2196f3; }
        .models { color: #4caf50; }
        .voice { color: #f44336; }
        .data { color: #795548; }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #3498db;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Smart Home Controller - High Level Entity Diagram</h1>
        
        <div class="section">
            <h2>System Architecture Overview</h2>
            <div class="diagram">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           SMART HOME CONTROLLER APP                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   APP LAYER     â”‚    â”‚ CONFIGURATION   â”‚    â”‚  STATE MGMT     â”‚    â”‚   VIEW LAYER    â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ SmartHomeApp    â”‚â—„â”€â”€â–ºâ”‚ VAPIConfig      â”‚â—„â”€â”€â–ºâ”‚ AppState        â”‚â—„â”€â”€â–ºâ”‚ ContentView     â”‚
â”‚                 â”‚    â”‚ HomeAssistant   â”‚    â”‚ CallManager     â”‚    â”‚ SidebarView     â”‚
â”‚                 â”‚    â”‚   Config        â”‚    â”‚                 â”‚    â”‚ SettingsView    â”‚
â”‚                 â”‚    â”‚ ZammadConfig    â”‚    â”‚                 â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â–²                        â–²                       
                                â”‚                        â”‚                       
                                â”‚                        â”‚                       
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EXTERNAL APIS   â”‚    â”‚ VOICE CONTROL   â”‚    â”‚ TEMPERATURE     â”‚    â”‚ ROOM SYSTEM     â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ HomeAssistant   â”‚â—„â”€â”€â–ºâ”‚ VAPI Client     â”‚â—„â”€â”€â–ºâ”‚ AnimatedTemp    â”‚â—„â”€â”€â–ºâ”‚ RoomView        â”‚
â”‚   Client        â”‚    â”‚ Daily.co SDK    â”‚    â”‚   CardViewModel â”‚    â”‚ Room Model      â”‚
â”‚ ZammadClient    â”‚    â”‚ Microphone      â”‚    â”‚ TempCard        â”‚    â”‚ DeviceStore     â”‚
â”‚                 â”‚    â”‚   Animation     â”‚    â”‚                 â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â–²                        â–²                       
                                â”‚                        â”‚                       
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ DEVICE CONTROL  â”‚    â”‚ SCENE SYSTEM    â”‚    â”‚ SUPPORT SYSTEM  â”‚    â”‚ MEDIA ASSETS    â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ SmartDevice     â”‚â—„â”€â”€â–ºâ”‚ Scene Model     â”‚â—„â”€â”€â–ºâ”‚ CreateTicket    â”‚â—„â”€â”€â–ºâ”‚ Assets.xcassets â”‚
â”‚ DeviceTemplate  â”‚    â”‚ SceneCardView   â”‚    â”‚   View          â”‚    â”‚ - Device Icons  â”‚
â”‚ DeviceGroup     â”‚    â”‚ HomeScene       â”‚    â”‚ TicketHistory   â”‚    â”‚ - Room Icons    â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚    â”‚ - Animations    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            </div>
        </div>

        <div class="section">
            <h2>Entity Relationships</h2>
            
            <h3>1. Core Dependencies</h3>
            <div class="flow-diagram">
AppState â”€â”€â–º CallManager â”€â”€â–º VAPI Client â”€â”€â–º Daily.co SDK
    â”‚             â”‚               â”‚
    â–¼             â–¼               â–¼
ContentView â”€â”€â–º RoomView â”€â”€â–º TempCard â”€â”€â–º AnimatedTempCardViewModel
            </div>

            <h3>2. Configuration Flow</h3>
            <div class="flow-diagram">
SettingsView â”€â”€â–º VAPIConfig â”€â”€â–º CallManager â”€â”€â–º Voice Control
             â”€â”€â–º HomeAssistantConfig â”€â”€â–º HomeAssistantClient â”€â”€â–º Device Control
             â”€â”€â–º ZammadConfig â”€â”€â–º ZammadClient â”€â”€â–º Support System
            </div>

            <h3>3. Voice Command Processing</h3>
            <div class="flow-diagram">
User Speech â”€â”€â–º CallManager â”€â”€â–º Transcript Processing â”€â”€â–º Temperature Commands
                    â”‚                                           â”‚
                    â–¼                                           â–¼
            Navigation Commands â”€â”€â–º AppState â”€â”€â–º View Updates â”€â”€â–º TempCard Animation
            </div>

            <h3>4. Data Models</h3>
            <div class="flow-diagram">
Room â”€â”€â–º SmartDevice â”€â”€â–º DeviceTemplate
  â”‚           â”‚              â”‚
  â–¼           â–¼              â–¼
Scene â”€â”€â–º DeviceGroup â”€â”€â–º DeviceHistory
            </div>

            <h3>5. UI Component Hierarchy</h3>
            <div class="flow-diagram">
ContentView
    â”œâ”€â”€ SidebarView
    â”‚   â”œâ”€â”€ Room Icons
    â”‚   â””â”€â”€ Settings Access
    â””â”€â”€ Main Content
        â”œâ”€â”€ RoomView
        â”‚   â”œâ”€â”€ TempCard
        â”‚   â””â”€â”€ Device Controls
        â””â”€â”€ GlobalMicrophoneOverlay
            </div>
        </div>

        <div class="section">
            <h2>Key Entity Types</h2>
            <div class="legend">
                <div class="legend-item views">ğŸ“± Views</div>
                <div class="legend-item viewmodels">ğŸ§  ViewModels</div>
                <div class="legend-item config">âš™ï¸ Configuration</div>
                <div class="legend-item apis">ğŸ“¡ External APIs</div>
                <div class="legend-item models">ğŸ  Domain Models</div>
                <div class="legend-item voice">ğŸ¤ Voice System</div>
                <div class="legend-item data">ğŸ“Š Data Storage</div>
            </div>

            <table>
                <tr>
                    <th>Entity Type</th>
                    <th>Components</th>
                    <th>Responsibility</th>
                </tr>
                <tr>
                    <td class="views">ğŸ“± Views</td>
                    <td>ContentView, SidebarView, RoomView, TempCard, SettingsView</td>
                    <td>User interface and interaction</td>
                </tr>
                <tr>
                    <td class="viewmodels">ğŸ§  ViewModels</td>
                    <td>AppState, CallManager, AnimatedTempCardViewModel</td>
                    <td>Business logic and state management</td>
                </tr>
                <tr>
                    <td class="config">âš™ï¸ Configuration</td>
                    <td>VAPIConfig, HomeAssistantConfig, ZammadConfig</td>
                    <td>External service configuration</td>
                </tr>
                <tr>
                    <td class="apis">ğŸ“¡ External APIs</td>
                    <td>VAPI Client, HomeAssistant Client, ZammadClient</td>
                    <td>External service integration</td>
                </tr>
                <tr>
                    <td class="models">ğŸ  Domain Models</td>
                    <td>Room, SmartDevice, Scene, DeviceGroup</td>
                    <td>Core domain logic and data structures</td>
                </tr>
                <tr>
                    <td class="voice">ğŸ¤ Voice System</td>
                    <td>MicrophoneAnimationView, Transcript Processing</td>
                    <td>Voice recognition and processing</td>
                </tr>
                <tr>
                    <td class="data">ğŸ“Š Data Storage</td>
                    <td>UserDefaults (configs), In-memory state</td>
                    <td>Data persistence and caching</td>
                </tr>
            </table>
        </div>

        <div class="section">
            <h2>Key Features</h2>
            <ul>
                <li><strong>Voice Control:</strong> VAPI integration for natural language commands</li>
                <li><strong>Temperature Control:</strong> Animated temperature adjustments with voice commands</li>
                <li><strong>Room Navigation:</strong> Voice-activated room switching</li>
                <li><strong>Device Management:</strong> Smart device control and monitoring</li>
                <li><strong>Scene Management:</strong> Pre-configured device scenes</li>
                <li><strong>Support System:</strong> Integrated ticketing via Zammad</li>
                <li><strong>Real-time Animation:</strong> Microphone visualization during voice interaction</li>
                <li><strong>Cross-transcript Processing:</strong> Handles split voice commands</li>
                <li><strong>Edge Case Handling:</strong> Robust speech recognition error handling</li>
                <li><strong>Configuration Management:</strong> Live-reloadable service configurations</li>
            </ul>
        </div>

        <div class="section">
            <h2>Technical Architecture</h2>
            <p><strong>Pattern:</strong> MVVM (Model-View-ViewModel) with SwiftUI</p>
            <p><strong>State Management:</strong> Combine framework with @Published properties</p>
            <p><strong>Voice Processing:</strong> VAPI + Daily.co SDK for real-time voice interaction</p>
            <p><strong>Navigation:</strong> NotificationCenter for decoupled room switching</p>
            <p><strong>Animation:</strong> SwiftUI animations with timer-based temperature changes</p>
            <p><strong>Configuration:</strong> Codable structs with UserDefaults persistence</p>
        </div>

        <div class="section">
            <p><em>Author : Karthi Jeyabalan</em></p>
            <p><em>Date: 07/08/2025</em></p>
        </div>
    </div>
</body>
</html>